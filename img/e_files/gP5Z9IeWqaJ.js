/*!CK:1185446360!*//*1440386568,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["tdf+2"]); }

__d("XFeedEgoImpressionLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ego\/feed\/logging\/impression\/",{ego_id:{type:"Int",required:true},qid:{type:"Int",required:true},mf_story_key:{type:"Int",required:true}});},null,{});
__d("XFeedEgoLoadController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ego\/feed\/load\/",{loading_id:{type:"String",required:true},ids:{type:"IntVector",required:true},service_id:{type:"String",required:true},replace_data:{type:"String",defaultValue:""},location:{type:"String",defaultValue:""},group_size:{type:"Int",defaultValue:1},qid:{type:"Int",required:true},mf_story_key:{type:"Int",required:true}});},null,{});
__d('EgoUnitCarousel',['CSS','DOM','tidyEvent','Animation','Ease','XFeedEgoImpressionLoggingController','AsyncRequest','Arbiter','Locale','XFeedEgoLoadController','cx','csx','Event'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){if(c.__markCompiled)c.__markCompiled();var u=39;function v(w){'use strict';this.positionProperty=p.isRTL()?'margin-right':'margin-left';var x=w.elements;this.loggedItems={};this.itemWidth=w.item_width;this.visibleCount=w.visible_count;this.visibleIndex=0;this.position=w.start_offset;this.slideCount=3;this.carousel=x.node;this.grid=x.grid;this.grid.style[this.positionProperty]=this.position+'px';this.grid.style.width=this.itemWidth*this.visibleCount+'px';o.subscribe('x-out-ego-suggestions',this.onXout.bind(this));this.serviceID=x.service_id;this.pager=x.pager;this.enableAutoScrolling=w.enable_auto_scrolling;this.enableLargePager=w.enable_large_pager;this.prevPager=x.prev_pager;this.nextPager=x.next_pager;this.location=x.location;if(this.enableLargePager){j([t.listen(this.nextPager,'click',this.slideLeft.bind(this)),t.listen(this.prevPager,'click',this.slideRight.bind(this))]);}else j([this.pager.subscribe('next',this.slideLeft.bind(this)),this.pager.subscribe('prev',this.slideRight.bind(this))]);this.$EgoUnitCarousel1();this.$EgoUnitCarousel2();this.$EgoUnitCarousel3();}v.prototype.canSlideLeft=function(){'use strict';return this.visibleIndex+this.visibleCount<this.grid.childElementCount;};v.prototype.canSlideRight=function(){'use strict';return this.visibleIndex>=1;};v.prototype.$EgoUnitCarousel4=function(w){'use strict';var x=JSON.parse(w.getAttribute('data-ft'));if(!x)return;var y=x.ego_id;if(!y)return;if(this.loggedItems[y])return;var z=m.getURIBuilder().setInt('ego_id',y).setInt('qid',x.qid).setInt('mf_story_key',x.mf_story_key).getURI();new n().setURI(z).send();this.loggedItems[y]=true;};v.prototype.toggleXouts=function(w,x,y){'use strict';};v.prototype.$EgoUnitCarousel1=function(){'use strict';var w=this.grid.children,x=w.length,y=this.visibleIndex+Math.min(this.visibleCount,x)-1;if(y===x-1)--y;for(var z=this.visibleIndex;z<=y;++z)this.$EgoUnitCarousel4(w[z]);};v.prototype.onXout=function(w,x){'use strict';if(!x)return;if(this.grid.childElementCount===0){i.remove(this.carousel);return;}if(this.grid.childElementCount>=this.visibleCount){var y=this.visibleIndex+this.visibleCount,z=this.grid.childElementCount-y;if(z<0)this.slide(-z);}this.$EgoUnitCarousel3();this.$EgoUnitCarousel1();this.$EgoUnitCarousel2();};v.prototype.$EgoUnitCarousel3=function(){'use strict';this.toggleXouts(this.visibleIndex,this.visibleIndex+this.visibleCount-1,false);if(this.enableAutoScrolling)this.updateAutoSlideListener();if(this.enableLargePager){this.updateLargePager();return;}if(this.grid.childElementCount<this.visibleCount){this.pager.setNextEnabled(false);this.pager.setPrevEnabled(false);return;}this.pager.setNextEnabled(this.canSlideLeft());this.pager.setPrevEnabled(this.canSlideRight());};v.prototype.slide=function(w){'use strict';this.toggleXouts(this.visibleIndex,this.visibleIndex+this.visibleCount,true);var x=0;if((this.enableAutoScrolling||this.enableLargePager)&&this.visibleIndex===0&&w>0)x=-u;var y=this.visibleIndex+w;if(y<=0){y=0;if(this.enableAutoScrolling||this.enableLargePager)x=u;}if(y+this.visibleCount>=this.grid.childElementCount)y=this.grid.childElementCount-this.visibleCount;w=y-this.visibleIndex;if(y===this.visibleIndex)return;this.position-=w*this.itemWidth+x;this.visibleIndex=y;var z=Math.abs(w*this.itemWidth);if(this.enableLargePager)h.addClass(this.carousel,"_4iwv");new k(this.grid).to(this.positionProperty,this.position).duration(z).ease(l.sineOut).ondone(this.$EgoUnitCarousel3.bind(this)).go();};v.prototype.slideRight=function(){'use strict';this.slide(-this.slideCount);};v.prototype.slideLeft=function(){'use strict';this.slide(this.slideCount);this.$EgoUnitCarousel1();this.$EgoUnitCarousel2();};v.prototype.$EgoUnitCarousel2=function(){'use strict';if(this.hasReq)return;var w=this.grid.childElementCount-this.visibleIndex-this.visibleCount-1;if(w>7)return;var x=i.scry(this.grid,"._34bp")[0];if(!x)return;var y=x.id,z=[],aa=this.grid.childNodes,ba=aa.length-1,ca,da;for(var ea=0;ea<ba;++ea){var fa=JSON.parse(aa[ea].getAttribute('data-ft'));if(fa.ego_id)z.push(fa.ego_id);if(fa.qid&&!ca)ca=fa.qid;if(fa.mf_story_key&&!da)da=fa.mf_story_key;}var ga=q.getURIBuilder().setString('service_id',this.serviceID).setString('location',this.location).setString('loading_id',y).setIntVector('ids',z).setInt('qid',ca).setInt('mf_story_key',da).getURI();new n().setURI(ga).setHandler(this.onDone.bind(this)).setErrorHandler(this.onError.bind(this)).send();this.hasReq=true;};v.prototype.onDone=function(w){'use strict';this.hasReq=false;if(w&&w.payload&&w.payload.items){var x=w.payload.items;if(x){var y=i.find(this.grid,"._34bp");i.insertBefore(y,x);this.$EgoUnitCarousel3();this.$EgoUnitCarousel1();this.$EgoUnitCarousel2();}}};v.prototype.onError=function(){'use strict';this.hasReq=false;};f.exports=v;},null);
__d('PYMKUnitCarousel',['CSS','DOM','Event','csx','debounce','cx','EgoUnitCarousel'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n){if(c.__markCompiled)c.__markCompiled();var o,p;o=babelHelpers.inherits(q,n);p=o&&o.prototype;q.prototype.updateAutoSlideListener=function(){'use strict';this.$PYMKUnitCarousel1();if(this.canSlideLeft())this.$PYMKUnitCarousel2('left',this.visibleIndex+this.visibleCount);if(this.canSlideRight())this.$PYMKUnitCarousel2('right',this.visibleIndex-1);};q.prototype.updateLargePager=function(){'use strict';h.removeClass(this.carousel,"_4iwv");this.$PYMKUnitCarousel3(true);this.$PYMKUnitCarousel3(false);h.conditionClass(this.carousel,"_4iww",this.canSlideLeft()&&this.canSlideRight());};q.prototype.$PYMKUnitCarousel3=function(r){'use strict';var s=r?"_4iwx":"_4iwy",t=r?"_4iwz":"_4iw-";if(r?this.canSlideRight():this.canSlideLeft()){h.removeClass(this.carousel,t);h.removeClass(this.carousel,s);}else{h.addClass(this.carousel,t);setTimeout((function(){h.addClass(this.carousel,s);}).bind(this),500);}};q.prototype.$PYMKUnitCarousel1=function(){'use strict';if(this.$PYMKUnitCarousel4)this.$PYMKUnitCarousel4.remove();this.$PYMKUnitCarousel4=null;if(this.$PYMKUnitCarousel5)this.$PYMKUnitCarousel5.remove();this.$PYMKUnitCarousel5=null;if(this.$PYMKUnitCarousel6)this.$PYMKUnitCarousel6.remove();this.$PYMKUnitCarousel6=null;if(this.$PYMKUnitCarousel7)this.$PYMKUnitCarousel7.remove();this.$PYMKUnitCarousel7=null;};q.prototype.$PYMKUnitCarousel2=function(r,s){'use strict';if(isNaN(s)||r!=='left'&&r!=='right')return;if(r==='left'){var t=l(this.slideLeft.bind(this),1000,this);this.$PYMKUnitCarousel4=j.listen(this.grid.children[s],'mouseover',t);this.$PYMKUnitCarousel6=j.listen(this.grid.children[s],'mouseout',function(){t.reset();});}else{var u=l(this.slideRight.bind(this),1000,this);this.$PYMKUnitCarousel5=j.listen(this.grid.children[s],'mouseover',u);this.$PYMKUnitCarousel7=j.listen(this.grid.children[s],'mouseout',function(){u.reset();});}};q.prototype.toggleXouts=function(r,s,t){'use strict';var u=Math.min(r,s),v=Math.max(r,s),w=this.grid.children;u=Math.max(u,0);v=Math.min(v,w.length-1);var x;for(var y=u;y<=v;++y){x=w[y];var z=i.scry(x,"._l98")[0];if(z)if(t){h.hide(z);}else h.show(z);}};function q(){'use strict';o.apply(this,arguments);}f.exports=q;},null);
__d("XEgoHideLoggingController",["XController"],function a(b,c,d,e,f,g){c.__markCompiled&&c.__markCompiled();f.exports=c("XController").create("\/ego\/feed\/logging\/xout\/",{ego_id:{type:"Int",required:true},qid:{type:"Int",required:true},mf_story_key:{type:"Int",required:true},service_id:{type:"String",required:true}});},null,{});
__d('PymkXout',['Event','DOM','CSS','Arbiter','XEgoHideLoggingController','AsyncSignal'],function a(b,c,d,e,f,g,h,i,j,k,l,m){if(c.__markCompiled)c.__markCompiled();var n={init:function(o,p,q){h.listen(p,'click',(function(event){this._logForItem(o);if(q==='pymk_jewel'||q==='pymk_jewel_first_page'){j.hide(o);}else i.remove(o);var r=event.getTarget().getAttribute('data-pymk-id');if(r)k.inform('x-out-ego-suggestions',{id:r});}).bind(this));},_logForItem:function(o){var p=JSON.parse(o.getAttribute('data-ft'));if(!p)return;if(!p.ego_id)return;var q=l.getURIBuilder().setInt('ego_id',p.ego_id).setInt('qid',p.qid).setInt('mf_story_key',p.mf_story_key).setString('service_id','PYMK').getURI();new m(q,{}).send();}};f.exports=n;},null);